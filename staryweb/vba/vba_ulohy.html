<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1250">
  
  <meta name="generator" content="PSPad editor, www.pspad.com">
  <title>Excel VBA - sbírka úloh</title>
  <style type="text/css">  
  h1 {color: black;}
  h2 {color: grey;}
  b {color: #8888ff}
  .console {  
    background-color: black;  
    color: #ffffff;  
    font-family: courier;  
  }  
  </style>
  <link href="syntax/Styles/SyntaxHighlighter.css" rel="stylesheet" type="text/css">
  <script language="javascript" type="text/javascript" src="syntax/Scripts/shCore.js"></script>   
  <script language="javascript" type="text/javascript" src="syntax/Scripts/shBrushVb.js"></script>   

   
  </head>
  <body>



<h1>Makra v Excelu - úlohy</h1>  

<h2>Cykly a podmínky</h2>
<p><b>Pøíklad 1.</b> Makro projde sloupec èíselných hodnot, každou hodnotu pøitom zvìtší o jednièku.</p>

<pre name="code" class="vb">
Sub PlusJedna()
  Do Until IsEmpty(ActiveCell)
    ActiveCell.Value = ActiveCell.Value + 1
    ActiveCell.Offset(1, 0).Select
  Loop
End Sub
</pre>

<p><b>Pøíklad 2.</b> Makro projde a podbarví sloupec èíselných hodnot, pøitom hodnoty vìtší než 5 barevnì odliší.</p>

<pre name="code" class="vb">
Sub Podbarveni()
  Do Until IsEmpty(ActiveCell)
    If ActiveCell.Value > 5 Then
      ActiveCell.Interior.Color = RGB(200, 160, 35)
    Else
      ActiveCell.Interior.Color = RGB(100, 160, 35)
    End If
    ActiveCell.Offset(1, 0).Select
  Loop
End Sub
</pre>

<p><b>Pøíklad 3.</b> Makro projde sloupec jmen osob a zvýrazní ta jména, která zaèínají písmenem "A".</p>

<pre name="code" class="vb">
Sub ZvyrazniA()
  Do Until IsEmpty(ActiveCell)
    If Left(ActiveCell.Value, 1) = "A" Then
      ActiveCell.Font.Bold = True
    End If
    ActiveCell.Offset(1, 0).Select
  Loop
End Sub 
</pre> 

<p><b>Pøíklad 4.</b> Makro projde sloupec èíselných hodnot. Pøitom vedle tohoto sloupce vytvoøí sloupec druhých mocnin hodnot z prvního sloupce.</p>

<pre name="code" class="vb">
Sub Mocniny()
  Do Until IsEmpty(ActiveCell)
    hodnota = ActiveCell.Value
    ActiveCell.Offset(0, 1).Select
    ActiveCell.Value = hodnota * hodnota
    ActiveCell.Offset(1, -1).Select
  Loop
End Sub
</pre> 


 
<h2>Úkoly:</h2>
<ol>

<li>V sešitu je sloupec známek z matematiky. Vytvoøte makro, které projde tento sloupec a všechny pìtky zvýrazní èervenì.</li>
<li>
V sešitu jsou dány dva sloupce èíselných hodnot (sloupce jsou stejnì dlouhé a nachází se vedle sebe). Vytvoøte makro, které vedle tìchto sloupcù vytvoøí tøetí svìtle modøe podbarvený sloupec. Každá buòka tohoto sloupce bude obsahovat souèet hodnot dvou bunìk ze zadaných sloupcù. 
</li>
<li>
V sešitu je sloupec známek z matematiky. Vytvoøte makro, které projde tento sloupec a pøitom do vedlejšího sloupce zapíše slovní vyjádøení každé známky ("výbornì", "chvalitebnì", ..., "nedostateènì").
</li>
<li>
V sešitu jsou dány dva sloupce, první obsahuje jména zamìstnancù a druhý jejich platy. Vytvoøte makro, které projde tyto dva sloupce, najde zamìstnance s nejvìtším platem a barevnì zvýrazní jeho jméno a plat.
</li>
</ol>
 
<h2>Práce s oblastmi bunìk</h2> 

<p>Nejprve si prostudujte ukázky na <a href="http://support.microsoft.com/kb/291308/cs">stránkách oficiální podpory Microsoft</a>.</p>

<p><b>Pøíklad 1.</b> Makro vybere souvislou oblast bunìk kolem aktuální buòky a seøadí ji vzestupnì podle aktuálního sloupce.</p>

<pre name="code" class="vb">
Sub Razeni()
  Dim oblast As Range
  Dim klic As Range
  Set oblast = Range(ActiveCell, ActiveCell).CurrentRegion
  Set klic = Range(ActiveCell, ActiveCell)
  oblast.Sort Key1:=klic
End Sub
</pre>

<h2>Úkoly:</h2>
<ol>
<li>
V sešitu jsou dány dva sloupce, první obsahuje jména atletù a druhý jejich výkony ve skoku dalekém. Vytvoøte makro, které souvislou oblast tvoøenou tìmito dvìma sloupci seøadí sestupnì podle výkonu ve skoku dalekém a do sloupce pøed tuto oblast vloží další sloupec, ve kterém bude poøadí atletù. První tøi atlety navíc zvýrazní barevnì.
</li>
<li>
V sešitu jsou dány dva sloupce, první obsahuje jména žákù (nemusí být seøazena podle abecedy) a druhý jejich známku z matematiky. Vytvoøte makro, které souvislou oblast tvoøenou tìmito dvìma sloupci seøadí podle sloupce jméno vzestupnì a do sloupce pøed tuto oblast vloží další sloupec, ve kterém budou první písmena jmen žákù.
</li>
<li>
V sešitu jsou dána v jednom sloupci jména žákù. Za každým jménem žáka jsou na øádku uvedeny jeho známky z matematiky (v každé buòce jedna známka, ale u každého žáka mùže být jiný poèet známek). Vytvoøte makro, které hned za sloupec jmen žákù vloží další sloupce, v nìmž bude pro každého žáka spoèítaný prùmìr jeho známek.
</li>
</ol>

<h2>Práce s funkcemi</h2>

<p><b>Pøíklad 1.</b> Ukázka použití volání funkce Sum.</p>

<pre name="code" class="vb">
Sub PouzitiFunkce()
  Range("C1").Value = Application.WorksheetFunction.Sum(Range("A1:A32"))
End Sub
</pre>

<h2>Úkoly:</h2>
<ol>
<li>
V sešitu jsou dány dva sloupce, první obsahuje jména atletù a druhý jejich výkony ve skoku dalekém. Vytvoøte makro, které vypoète a pøehlednì vypíše základní statistické charakteristiky tohoto souboru - aritmetický prùmìr, smìrodatnou odchylku, maximum a minimum.
</li>
</ol>

  <script language="javascript" type="text/javascript">  
   dp.SyntaxHighlighter.ClipboardSwf = "syntax/Styles/clipboard.swf";   
   dp.SyntaxHighlighter.BloggerMode();  
   dp.SyntaxHighlighter.HighlightAll('code');   
  </script>    
  


</body></html>